<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="utf-8">
	<title>RandomizeMe</title>
	<style>
		.container {
			width: 50%;
			margin: 0 auto;
		}
		#result, #text {
			width: 100%;
			max-height: 200px;
			border: 1px solid black;
		}
	</style>
	<script src="../index.js"></script>
</head>
<body>
	<div class="container">
		<textarea id="text">Нашего директора зовут [[ objects ]] и поэтому наш [[ who ]] [[ action ]] вам [[ food ]].</textarea>
		<input type="button" id="test" value="Сгенерировать текст">
		<div id="result"></div>
	</div>

	<script type="text/javascript">
		var Randomize = new RandomizeMe();

		var options = {
			tags: {
				open: "[[",
				close: "]]"
			},
			actions: {
				number: function(min, max) {
					return Randomize.tools.Number(min, max);
				},
				choice: function() {
					return Randomize.tools.Choice(...arguments);
				},
				objects: function() {
					let $array = [
						{name:"Федор"}, 
						{name:"Акакий"}, 
						{name:"Феоктист"}, 
						{name:"Иван"}
					];
					let $value = Randomize.tools.Choice($array, 1, true);
					return $value.name;
				},
				who: function() {
					let $array = ["сайт", "проект", "магазин", "дурдом"];
					let $index = Randomize.tools.Choice($array);
					return $array[$index];
				},
				action: function() {
					let $array = ["предлагает", "рекомендует", "советует", "навязывает"];
					let $value = Randomize.tools.Choice($array, 1, true);
					return $value;
				},
				food: function() {
					let $count = Randomize.render(' по цене [[ number(50, 150) ]] р. за [[ number(1, 10) ]] [[ choice(["кг", "г"],1,true) ]]');
					let $array = ["селёдочку", "колбаску", "грибочки", "огурчики"];
					let $index = Randomize.tools.Choice($array);
					return $array[$index] + $count;
				}
			}
		}

		Randomize.configure(options);

		window.addEventListener("DOMContentLoaded", function(){
			var button = document.getElementById("test");
			var textarea = document.getElementById("text");
			var result = document.getElementById("result");

			button.addEventListener("click", function(){
				var template = textarea.value;
				result.innerHTML = Randomize.render(template);
			});
		});
	</script>
</body>
</html>